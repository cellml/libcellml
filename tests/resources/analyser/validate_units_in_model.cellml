<?xml version='1.0' encoding='UTF-8'?>
<model name="validate_units_in_model" xmlns="http://www.cellml.org/cellml/2.0#" xmlns:cellml="http://www.cellml.org/cellml/2.0#">
    <units name="volt_per_farad">
        <unit units="volt"/>
        <unit exponent="-1" units="farad"/>
    </units>
    <units name="metre_per_second">
        <unit units="metre"/>
        <unit exponent="-1" units="second"/>
    </units>
    <units name="apple"/>
    <units name="milliapple">
        <unit prefix="milli" units="apple"/>
    </units>
    <units name="apple_and_milliapple">
        <unit units="milliapple"/>
        <unit units="apple"/>
    </units>
    <!-- Simple checks for direct comparision operator behaviour (plus, minus. equals, less than, etc).-->
    <component name="direct_comparision_operators">
        <variable interface="public" name="a" units="volt_per_farad"/>
        <variable interface="public" name="b" units="metre_per_second"/>
        <variable interface="public" name="c" units="metre_per_second"/>
        <variable interface="public" name="d" units="metre_per_second"/>
        <variable interface="public" name="k" units="metre_per_second"/>
        <variable initial_value="1" name="z" units="metre_per_second"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>a</ci>
                <apply>
                    <plus/>
                    <ci>b</ci>
                    <ci>c</ci>
                </apply>
            </apply>
            <!-- Not allowed, we have a unit mismatch between (b+c) and a, for the sign "=".-->
            <apply>
                <eq/>
                <ci>d</ci>
                <apply>
                    <plus/>
                    <ci>b</ci>
                    <apply>
                        <power/>
                        <ci>c</ci>
                        <cn cellml:units="dimensionless">2</cn>
                    </apply>
                </apply>
            </apply>
            <!-- Also should return an error as the exponent creates a mismatch.-->
            <apply>
                <eq/>
                <ci>z</ci>
                <apply>
                    <plus/>
                    <ci>b</ci>
                    <ci>c</ci>
                </apply>
            </apply>
        </math>
        <!-- Allowed.-->
    </component>
    <component name="trigonometric_operators">
        <variable interface="public" name="arg" units="second"/>
        <variable interface="public" name="op_resultNotAllowed" units="dimensionless"/>
        <variable interface="public" name="op_resultAllowed" units="dimensionless"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>op_resultNotAllowed</ci>
                <apply>
                    <tan/>
                    <ci>arg</ci>
                </apply>
            </apply>
            <!--Not allowed - we can only take tan of dimensionless arguments-->
            <apply>
                <eq/>
                <ci>op_resultAllowed</ci>
                <apply>
                    <tan/>
                    <apply>
                        <divide/>
                        <ci>arg</ci>
                        <ci>arg</ci>
                    </apply>
                </apply>
            </apply>
        </math>
        <!-- Allowed-->
    </component>
    <component name="logarithmic_operators">
        <variable interface="public" name="in_A" units="second"/>
        <variable interface="public" name="out_A" units="dimensionless"/>
        <variable interface="public" name="out_B" units="dimensionless"/>
        <variable interface="public" name="out_C" units="dimensionless"/>
        <variable interface="public" name="in_B" units="dimensionless"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>out_A</ci>
                <apply>
                    <log/>
                    <logbase>
                        <cn cellml:units="dimensionless">2</cn>
                    </logbase>
                    <ci>in_A</ci>
                </apply>
            </apply>
            <!-- Not allowed to have a mismatch in the base and actual logarithm-->
            <apply>
                <eq/>
                <ci>out_B</ci>
                <apply>
                    <log/>
                    <logbase>
                        <cn cellml:units="second">2</cn>
                    </logbase>
                    <ci>in_A</ci>
                </apply>
            </apply>
            <!-- Allowed-->
            <apply>
                <eq/>
                <ci>out_C</ci>
                <apply>
                    <log/>
                    <logbase>
                        <cn cellml:units="dimensionless">2</cn>
                    </logbase>
                    <ci>in_B</ci>
                </apply>
            </apply>
        </math>
        <!-- Allowed-->
    </component>
    <component name="power_root_operators">
        <variable interface="public" name="f" units="volt_per_farad"/>
        <variable interface="public" name="g" units="volt_per_farad"/>
        <variable interface="public" name="h" units="volt_per_farad"/>
        <variable interface="public" name="i" units="dimensionless"/>
        <variable interface="public" name="j" units="dimensionless"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>g</ci>
                <apply>
                    <root/>
                    <apply>
                        <power/>
                        <ci>f</ci>
                        <cn cellml:units="dimensionless">2</cn>
                    </apply>
                </apply>
            </apply>
            <!-- Allowed-->
            <apply>
                <eq/>
                <ci>h</ci>
                <apply>
                    <root/>
                    <apply>
                        <power/>
                        <ci>f</ci>
                        <cn cellml:units="dimensionless">2</cn>
                    </apply>
                </apply>
            </apply>
            <!-- Allowed-->
            <apply>
                <eq/>
                <ci>j</ci>
                <apply>
                    <exp/>
                    <ci>i</ci>
                </apply>
            </apply>
            <!-- Allowed as both e and i are dimensionless although i is not a fixed value.-->
            <apply>
                <eq/>
                <ci>j</ci>
                <apply>
                    <power/>
                    <ci>h</ci>
                    <cn cellml:units="second">2</cn>
                </apply>
            </apply>
        </math>
        <!-- Not allowed - 2 is not dimensionless-->
    </component>
    <component name="non_standard_units">
        <variable interface="public" name="A_p" units="apple"/>
        <variable interface="public" name="A_m" units="milliapple"/>
        <variable interface="public" name="A_out" units="milliapple"/>
        <variable interface="public" name="time" units="second"/>
        <variable interface="public" name="A_into" units="apple_and_milliapple"/>
        <variable interface="public" name="A_o" units="apple_and_milliapple"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>time</ci>
                    </bvar>
                    <ci>A_out</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <times/>
                        <ci>A_p</ci>
                        <ci>A_m</ci>
                    </apply>
                    <apply>
                        <times/>
                        <ci>A_p</ci>
                        <ci>time</ci>
                    </apply>
                </apply>
            </apply>
            <!-- Should be allowed both for multipliers and units checking.-->
            <apply>
                <eq/>
                <ci>A_o</ci>
                <ci>A_into</ci>
            </apply>
        </math>
        <!-- Cvoerage for nested base units which are not standard-->
    </component>
</model>
